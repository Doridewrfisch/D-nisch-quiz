<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>D√§nisch Karteikarten</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="antialiased">
  <div id="root"></div>

  <script>
  // Plain JavaScript implementation (no React/Babel)
  (function () {
    const initialVocabulary = [
    { danish: "en ting", german: "eine Sache/ein Ding" },
    { danish: "det rigtige tal", german: "die richtige Zahl" },
    { danish: "en kop", german: "eine Tasse" },
    { danish: "en stol", german: "ein Stuhl" },
    { danish: "en taske", german: "eine Tasche" },
    { danish: "en blyant", german: "ein Bleistift" },
    { danish: "en d√∏r", german: "eine T√ºr" },
    { danish: "en flaske", german: "eine Flasche" },
    { danish: "en kuglepen", german: "ein Kugelschreiber" },
    { danish: "en b√¶rbar", german: "ein Laptop" },
    { danish: "en computer", german: "ein Computer" },
    { danish: "et bord", german: "ein Tisch" },
    { danish: "at h√¶nge", german: "h√§ngen" },
    { danish: "et skab", german: "ein Schrank" },
    { danish: "et pennalhus", german: "ein Federm√§ppchen" },
    { danish: "et h√¶fte", german: "ein Heft" },
    { danish: "et ur", german: "eine Uhr" },
    { danish: "et glas", german: "ein Glas" },
    { danish: "pege p√•", german: "zeigen auf" },
    { danish: "at stille", german: "stellen" },
    { danish: "at tegne", german: "zeichnen" },
    { danish: "et substantiv", german: "ein Substantiv" },
    { danish: "ubestemt", german: "unbestimmt" },
    { danish: "en artikel", german: "ein Artikel" },
    { danish: "foran", german: "vor/vorne" },
    { danish: "bestemte", german: "bestimmt" },
    { danish: "ende p√•", german: "enden auf" },
    { danish: "ubetonet", german: "unbetont" },
    { danish: "en form", german: "eine Form" },
    { danish: "en konsonant", german: "ein Konsonant" },
    { danish: "et klassev√¶relse", german: "ein Klassenzimmer" },
    { danish: "er der?", german: "gibt es?" },
    { danish: "et gardin", german: "ein Vorhang" },
    { danish: "en reol", german: "ein Regal" },
    { danish: "en opslagstavle", german: "eine Pinnwand" },
    { danish: "en kalender", german: "ein Kalender" },
    { danish: "en f√∏dselsdag", german: "ein Geburtstag" },
    { danish: "hvor mange", german: "wie viele" },
    { danish: "en v√¶g", german: "eine Wand" },
    { danish: "et vindue", german: "ein Fenster" },
    { danish: "en lampe", german: "eine Lampe" },
    { danish: "ellers", german: "sonst/oder" },
    { danish: "et ark", german: "ein Blatt (Papier)" },
    { danish: "fugleperspektiv", german: "Vogelperspektive" },
    { danish: "en sofa", german: "ein Sofa" },
    { danish: "en projektor", german: "ein Projektor" },
    { danish: "en interaktiv tavle", german: "ein interaktives Whiteboard" },
    { danish: "en sk√¶rm", german: "ein Bildschirm" },
    { danish: "en tavle", german: "eine Tafel" },
    { danish: "kridt", german: "Kreide" },
    { danish: "udvekslingsklasse", german: "Austauschklasse" },
    { danish: "dreng", german: "Junge" },
    { danish: "lydbesked", german: "Sprachnachricht" },
    { danish: "fort√¶lle", german: "erz√§hlen" },
    { danish: "beskrivelse", german: "Beschreibung" },
    { danish: "loft", german: "Decke" },
    { danish: "elev", german: "Sch√ºler/in" },
    { danish: "pige", german: "M√§dchen" },
    { danish: "vand", german: "Wasser" },
    { danish: "sprog", german: "Sprache" },
    { danish: "rullegardin", german: "Rollo" },
    { danish: "filmklip", german: "Videoclip" },
    { danish: "derefter", german: "danach" },
    { danish: "egentlig", german: "eigentlich" },
    { danish: "kun", german: "nur" },
    { danish: "ud til gangen", german: "zur Flur/zum Gang" },
    { danish: "midt i", german: "mitten in" },
    { danish: "s√•", german: "dann/so" },
    { danish: "sammen", german: "zusammen" },
    { danish: "selvf√∏lgelig", german: "selbstverst√§ndlich" },
    { danish: "pr√¶sentere", german: "pr√§sentieren" },
    { danish: "tro", german: "glauben" },
    { danish: "cirka", german: "circa/ungef√§hr" },
    { danish: "time", german: "Stunde" },
    { danish: "skoletaske", german: "Schultasche" },
    { danish: "gulv", german: "Boden/Fu√üboden" },
    { danish: "altid", german: "immer" },
    { danish: "mediering", german: "Mediation" },
    { danish: "frikvarter", german: "Pause" },
    { danish: "anden", german: "zweite/andere" },
    { danish: "mediere", german: "vermitteln" },
    { danish: "betyde", german: "bedeuten" },
    { danish: "at", german: "dass" },
    { danish: "andet", german: "anderes" },
    { danish: "begge", german: "beide" },
    { danish: "skal", german: "soll/muss" },
    { danish: "tekst", german: "Text" },
    { danish: "overs√¶tte", german: "√ºbersetzen" },
    { danish: "vigtig", german: "wichtig" }
  ];

    // State
    let vocabulary = [];
    let cards = [];
    let currentIndex = 0;
    let isFlipped = false;
    let isAnimating = false;
    let showDanish = true;
    let difficultCards = [];
    let knownCards = [];
    let showButtons = false;
    let reviewMode = false;
    let showManager = false;
    let editIndex = null;

    // DOM helpers
    const $ = (sel) => document.querySelector(sel);

    function loadVocabulary() {
      try {
        const savedStr = localStorage.getItem('danish-vocabulary');
        if (savedStr) {
          vocabulary = JSON.parse(savedStr);
        } else {
          vocabulary = initialVocabulary.slice();
          saveVocabulary(vocabulary);
        }
      } catch (err) {
        vocabulary = initialVocabulary.slice();
        saveVocabulary(vocabulary);
      }
      cards = shuffleArray(vocabulary.slice());
      render();
    }

    function saveVocabulary(v) {
      try { localStorage.setItem('danish-vocabulary', JSON.stringify(v)); } catch (e) { console.error(e); }
    }

    function shuffleArray(arr) { return arr.sort(() => Math.random() - 0.5); }

    // Actions
    function addVocabulary(danish, german) {
      if (!danish || !german) return alert('Beide Felder ausf√ºllen');
      vocabulary.push({ danish: danish.trim(), german: german.trim() });
      saveVocabulary(vocabulary);
      cards = shuffleArray(vocabulary.slice());
      renderManager();
    }

    function deleteVocabulary(index) {
      if (!confirm('M√∂chtest du diese Vokabel wirklich l√∂schen?')) return;
      vocabulary.splice(index, 1);
      saveVocabulary(vocabulary);
      cards = shuffleArray(vocabulary.slice());
      renderManager();
    }

    function startEdit(i) { editIndex = i; renderManager(); }
    function saveEdit(danish, german) {
      if (editIndex === null) return;
      vocabulary[editIndex] = { danish: danish.trim(), german: german.trim() };
      saveVocabulary(vocabulary);
      editIndex = null;
      cards = shuffleArray(vocabulary.slice());
      renderManager();
    }

    function cancelEdit() { editIndex = null; renderManager(); }

    function shuffleCards() { cards = shuffleArray(vocabulary.slice()); currentIndex = 0; isFlipped = false; showButtons = false; reviewMode = false; render(); }

    function flipCard() {
      if (isAnimating) return; // Verhindere Neu-Flip w√§hrend Animation
      isFlipped = !isFlipped;
      const cardInner = $('#cardInner');
      if (!cardInner) {
        // Fallback: kein Card-Element vorhanden
        showButtons = isFlipped;
        render();
        return;
      }
      isAnimating = true;

      const onTransitionEnd = (e) => {
        if (e.propertyName && e.propertyName.indexOf('transform') === -1) return;
        isAnimating = false;
        showButtons = isFlipped; // Buttons erst nach komplettem Umdrehen zeigen
        cardInner.removeEventListener('transitionend', onTransitionEnd);
        // Nur die Karte und Aktionsfl√§che aktualisieren, um DOM-Neuerstellung zu vermeiden
        renderCard();
        updateActionArea();
      };

      cardInner.addEventListener('transitionend', onTransitionEnd, { once: true });
      // Starte die Rotation (die Transition in CSS sorgt f√ºr die Animation)
      cardInner.style.transform = isFlipped ? 'rotateY(180deg)' : 'rotateY(0deg)';
    }

    function markAsKnown() {
      const current = cards[currentIndex];
      if (!knownCards.find(c => c.danish === current.danish)) knownCards.push(current);
      difficultCards = difficultCards.filter(c => c.danish !== current.danish);
      nextCard();
    }

    function markAsDifficult() { const current = cards[currentIndex]; if (!difficultCards.find(c=>c.danish===current.danish)) difficultCards.push(current); nextCard(); }

    function nextCard() { showButtons = false; isFlipped = false; if (currentIndex < cards.length - 1) currentIndex++; else if (reviewMode && difficultCards.length>0) currentIndex = 0; render(); }
    function prevCard() { if (currentIndex>0) { currentIndex--; isFlipped=false; showButtons=false; render(); } }

    function toggleDirection() { showDanish = !showDanish; isFlipped = false; showButtons = false; render(); }

    function startReviewMode() {
      if (!difficultCards || difficultCards.length === 0) {
        return alert('Keine markierten schwierigen Karten zum Wiederholen.');
      }
      cards = shuffleArray(difficultCards.slice());
      currentIndex = 0;
      isFlipped = false;
      showButtons = false;
      reviewMode = true;
      render();
    }

    function resetProgress() { difficultCards = []; knownCards = []; shuffleCards(); }

    // Rendering
    function render() {
      renderMain();
      renderManager();
    }

    function renderMain() {
      const root = $('#root');
      const currentCard = cards[currentIndex] || { danish: '', german: '' };
      const frontText = showDanish ? currentCard.danish : currentCard.german;
      const backText = showDanish ? currentCard.german : currentCard.danish;

      root.innerHTML = `
        <div class="min-h-screen bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-500 flex flex-col items-center justify-center p-6">
          <div class="max-w-3xl w-full">
            <div class="text-center mb-8">
              <h1 class="text-6xl font-black text-white mb-3 drop-shadow-lg">üá©üá∞ D√§nisch Karteikarten üá©üá™</h1>
              <p class="text-white text-lg opacity-90">Klicke auf die Karte zum Umdrehen</p>
              <button id="toggleManager" class="mt-6 bg-white text-indigo-600 px-6 py-3 rounded-full font-bold hover:bg-indigo-50 shadow-lg">üìö Vokabeln verwalten (${vocabulary.length})</button>
            </div>

            <div class="bg-white rounded-3xl shadow-2xl p-8 mb-6">
              <div class="grid grid-cols-3 gap-4 text-center mb-8">
                <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-2xl p-4 border-2 border-green-300">
                  <p class="text-4xl font-black text-green-600">${knownCards.length}</p>
                  <p class="text-sm font-semibold text-green-700 mt-1">Gewusst ‚úì</p>
                </div>
                <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-2xl p-4 border-2 border-red-300">
                  <p class="text-4xl font-black text-red-600">${difficultCards.length}</p>
                  <p class="text-sm font-semibold text-red-700 mt-1">Schwierig</p>
                </div>
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl p-4 border-2 border-blue-300">
                  <p class="text-4xl font-black text-blue-600">${cards.length}</p>
                  <p class="text-sm font-semibold text-blue-700 mt-1">Gesamt</p>
                </div>
              </div>

              <div class="mt-10">
                <div id="card" class="select-none cursor-pointer rounded-3xl shadow-2xl" style="perspective: 1000px; min-height: 350px;">
                  <div id="cardInner" class="relative w-full h-full transition-transform duration-600" style="transform-style: preserve-3d; min-height: 350px; width: 100%;">
                    <div id="cardFront" class="w-full h-full flex items-center justify-center p-6 rounded-3xl bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 text-white shadow-xl" style="backface-visibility: hidden; -webkit-backface-visibility: hidden;">
                      <div class="text-center">
                        <p class="text-sm font-semibold opacity-75 mb-3">D√§nisch</p>
                        <div class="text-5xl font-bold break-words">${escapeHtml(frontText)}</div>
                        <p class="text-sm opacity-60 mt-6">Klicke zum Umdrehen</p>
                      </div>
                    </div>
                    <div id="cardBack" class="w-full h-full flex items-center justify-center p-6 rounded-3xl bg-gradient-to-br from-pink-500 via-red-500 to-orange-500 text-white shadow-xl absolute inset-0" style="backface-visibility: hidden; -webkit-backface-visibility: hidden; transform: rotateY(180deg);">
                      <div class="text-center">
                        <p class="text-sm font-semibold opacity-75 mb-3">Deutsch</p>
                        <div class="text-5xl font-bold break-words">${escapeHtml(backText)}</div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="flex justify-between items-center mt-8 gap-3">
                  <div class="flex gap-2">
                    <button id="prevBtn" class="px-4 py-3 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-full font-bold shadow-md">‚ü® Zur√ºck</button>
                    <button id="nextBtn" class="px-4 py-3 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-full font-bold shadow-md">Weiter ‚ü©</button>
                    <button id="shuffleBtn" class="px-4 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-full font-bold shadow-md">üîÄ Mischen</button>
                  </div>

                  <div class="flex gap-2">
                    <button id="toggleDir" class="px-4 py-3 bg-purple-500 hover:bg-purple-600 text-white rounded-full font-bold shadow-md">‚ÜîÔ∏è Richtung</button>
                    <button id="resetBtn" class="px-4 py-3 bg-red-500 hover:bg-red-600 text-white rounded-full font-bold shadow-md">üîÑ Reset</button>
                  </div>
                </div>

                <div id="actionArea">${showButtons ? `
                  <div class="flex gap-4 mt-8">
                    <button id="difficultBtn" class="flex-1 bg-gradient-to-r from-red-500 to-orange-500 hover:from-red-600 hover:to-orange-600 text-white px-6 py-4 rounded-2xl font-bold text-lg shadow-lg">‚ùå Schwierig</button>
                    <button id="knownBtn" class="flex-1 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white px-6 py-4 rounded-2xl font-bold text-lg shadow-lg">‚úÖ Gewusst</button>
                  </div>
                ` : ''}</div>
              </div>
            </div>
          </div>
        </div>
      `;

      $('#toggleManager').addEventListener('click', () => { showManager = true; render(); });
      const cardEl = $('#card'); if (cardEl) cardEl.addEventListener('click', () => { if (isAnimating) return; flipCard(); });
      $('#prevBtn').addEventListener('click', prevCard);
      $('#nextBtn').addEventListener('click', nextCard);
      $('#shuffleBtn').addEventListener('click', shuffleCards);
      $('#toggleDir').addEventListener('click', toggleDirection);
      $('#resetBtn').addEventListener('click', resetProgress);
      
      // Render card faces and attach general listeners
      renderCard();

      // Re-attach button listeners if visible via actionArea
      updateActionArea();
    }

    // Add CSS for flip animation (in JS so it's included in single file)
    (function addFlipStyles(){
      const css = `
        * { box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        .card-face { backface-visibility: hidden; transform-style: preserve-3d; }
        #cardInner { transform-style: preserve-3d; transition: transform 600ms cubic-bezier(0.68, -0.55, 0.265, 1.55); }
        #cardInner.flipped { transform: rotateY(180deg); }
        .rotate-y-180 { transform: rotateY(180deg); }
        
        #cardFront, #cardBack { 
          min-height: 300px;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          box-shadow: 0 20px 60px rgba(102, 126, 234, 0.4);
          border-radius: 20px;
        }
        #cardBack {
          background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
          box-shadow: 0 20px 60px rgba(245, 87, 108, 0.4);
        }
        
        button { cursor: pointer; transition: all 300ms ease; }
        button:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
        button:active { transform: translateY(-1px); }
      `;
      const style = document.createElement('style'); style.appendChild(document.createTextNode(css)); document.head.appendChild(style);
    })();

    function renderManager() {
      // If not in manager mode, nothing to do
      if (!showManager) return;
      const root = $('#root');
      root.innerHTML = `
        <div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
          <div class="max-w-4xl mx-auto">
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
              <div class="flex justify-between items-center mb-6">
                <h1 class="text-3xl font-bold text-gray-800">Vokabel-Verwaltung</h1>
                <button id="backBtn" class="bg-indigo-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-indigo-700 transition">Zur√ºck zum Lernen</button>
              </div>

              <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-4 mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-3">${editIndex !== null ? 'Vokabel bearbeiten' : 'Neue Vokabel hinzuf√ºgen'}</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                  <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">D√§nisch</label>
                    <input id="danishInput" type="text" placeholder="z.B. en bog" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none" />
                  </div>
                  <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Deutsch</label>
                    <input id="germanInput" type="text" placeholder="z.B. ein Buch" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none" />
                  </div>
                </div>
                <div class="flex gap-2">
                  <button id="saveVocabBtn" class="w-full bg-green-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-green-700 transition">${editIndex !== null ? 'Speichern' : '‚ûï Vokabel hinzuf√ºgen'}</button>
                  ${editIndex !== null ? '<button id="cancelEditBtn" class="bg-gray-500 text-white px-4 py-2 rounded-lg">Abbrechen</button>' : ''}
                </div>
              </div>

              <div class="mb-4"><h3 class="text-lg font-bold text-gray-800 mb-2">Gesamt: ${vocabulary.length} Vokabeln</h3></div>

              <div class="space-y-2 max-h-96 overflow-y-auto">
                ${vocabulary.map((vocab, index) => `
                  <div class="bg-gray-50 border-2 border-gray-200 rounded-lg p-4 flex justify-between items-center hover:bg-gray-100 transition">
                    <div class="flex-1">
                      <p class="font-semibold text-indigo-600">${escapeHtml(vocab.danish)}</p>
                      <p class="text-gray-700">${escapeHtml(vocab.german)}</p>
                    </div>
                    <div class="flex gap-2">
                      <button data-edit="${index}" class="editBtn bg-blue-500 text-white p-2 rounded-lg hover:bg-blue-600 transition">‚úèÔ∏è</button>
                      <button data-delete="${index}" class="deleteBtn bg-red-500 text-white p-2 rounded-lg hover:bg-red-600 transition">üóëÔ∏è</button>
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>
          </div>
        </div>
      `;

      // Prefill inputs if editing
      const danishInput = $('#danishInput');
      const germanInput = $('#germanInput');
      if (editIndex !== null) {
        danishInput.value = vocabulary[editIndex].danish;
        germanInput.value = vocabulary[editIndex].german;
      } else { danishInput.value = ''; germanInput.value = ''; }

      $('#backBtn').addEventListener('click', () => { showManager = false; editIndex = null; render(); });
      $('#saveVocabBtn').addEventListener('click', () => {
        const d = danishInput.value.trim();
        const g = germanInput.value.trim();
        if (!d || !g) return alert('Beide Felder ausf√ºllen');
        if (editIndex !== null) saveEdit(d, g); else addVocabulary(d, g);
      });
      const cancelBtn = $('#cancelEditBtn'); if (cancelBtn) cancelBtn.addEventListener('click', cancelEdit);

      // Attach edit/delete handlers
      document.querySelectorAll('.editBtn').forEach(btn => btn.addEventListener('click', (e) => { startEdit(Number(e.currentTarget.dataset.edit)); }));
      document.querySelectorAll('.deleteBtn').forEach(btn => btn.addEventListener('click', (e) => { deleteVocabulary(Number(e.currentTarget.dataset.delete)); }));
    }

    function renderCard() {
      const cardFront = $('#cardFront');
      const cardBack = $('#cardBack');
      const cardInner = $('#cardInner');
      if (!cardInner || !cardFront || !cardBack) return;
      const currentCard = cards[currentIndex] || { danish: '', german: '' };
      const frontText = showDanish ? currentCard.danish : currentCard.german;
      const backText = showDanish ? currentCard.german : currentCard.danish;
      cardFront.innerHTML = `<div class="text-center"><p class="text-sm font-semibold opacity-75 mb-3">D√§nisch</p><div class="text-5xl font-bold break-words">${escapeHtml(frontText)}</div><p class="text-sm opacity-60 mt-6">Klicke zum Umdrehen</p></div>`;
      cardBack.innerHTML = `<div class="text-center"><p class="text-sm font-semibold opacity-75 mb-3">Deutsch</p><div class="text-5xl font-bold break-words">${escapeHtml(backText)}</div></div>`;
      // Apply rotation class
      if (isFlipped) {
        cardInner.style.transform = 'rotateY(180deg)';
      } else {
        cardInner.style.transform = 'rotateY(0deg)';
      }
    }

    function updateActionArea() {
      const area = $('#actionArea');
      if (!area) return;
      if (showButtons) {
        area.innerHTML = `
          <div class="flex gap-4 mt-8">
            <button id="difficultBtn" class="flex-1 bg-gradient-to-r from-red-500 to-orange-500 hover:from-red-600 hover:to-orange-600 text-white px-6 py-4 rounded-2xl font-bold text-lg shadow-lg">‚ùå Schwierig</button>
            <button id="knownBtn" class="flex-1 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white px-6 py-4 rounded-2xl font-bold text-lg shadow-lg">‚úÖ Gewusst</button>
          </div>
        `;
        const knownBtn = $('#knownBtn');
        const difficultBtn = $('#difficultBtn');
        if (knownBtn) knownBtn.addEventListener('click', () => {
          // mark known and then move to next card
          markAsKnown();
        });
        if (difficultBtn) difficultBtn.addEventListener('click', () => {
          markAsDifficult();
        });
      } else {
        area.innerHTML = '';
      }
    }

    function escapeHtml(str) { if (!str) return ''; return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    // init
    loadVocabulary();
  })();
  </script>
  </body>
  </html>